<div
  class="document-create-modal"
  [class.rtl]="isRTL"
  [attr.dir]="isRTL ? 'rtl' : 'ltr'"
  >
  <h2 mat-dialog-title [class.arabic-font]="isRTL">
    {{ "documents.create.modalTitle" | translate }}
  </h2>

  <mat-dialog-content>
    <form [formGroup]="documentForm" class="document-form">
      <!-- Document Title -->
      <mat-form-field appearance="outline" class="form-field">
        <mat-label>{{ "documents.form.title" | translate }}</mat-label>
        <input
          matInput
          formControlName="title"
          [placeholder]="'documents.form.titlePlaceholder' | translate"
          />
          @if (documentForm.get('title')?.hasError('required')) {
            <mat-error>
              {{ "documents.create.validation.required" | translate }}
            </mat-error>
          }
          @if (documentForm.get('title')?.hasError('maxlength')) {
            <mat-error>
              {{ "documents.create.validation.maxLength" | translate }}
            </mat-error>
          }
        </mat-form-field>

        <!-- From Department -->
        <!-- Department and Priority in one row -->
        <div class="flex-row-container">
          <mat-form-field appearance="outline" class="form-field mr-2">
            <mat-label>{{ "documents.form.department" | translate }}</mat-label>
            <mat-select formControlName="fromDepartment">
              @for (department of departments; track department) {
                <mat-option
                  [value]="department.id"
                  >
                  {{ isRTL ? department.name_ar : department.name_en }}
                </mat-option>
              }
            </mat-select>
            @if (documentForm.get('fromDepartment')?.hasError('required')) {
              <mat-error
                >
                {{ "documents.create.validation.required" | translate }}
              </mat-error>
            }
          </mat-form-field>

          <!-- Priority -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>{{ "documents.form.priority" | translate }}</mat-label>
            <mat-select formControlName="priority">
              @for (priority of priorities; track priority) {
                <mat-option [value]="priority.toLowerCase()">
                  {{ priority.toLowerCase() | translate }}
                </mat-option>
              }
            </mat-select>
            @if (documentForm.get('priority')?.hasError('required')) {
              <mat-error>
                {{ "documents.create.validation.required" | translate }}
              </mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Document Description -->
        <div class="flex-row-container">
          <textarea
            class="form-field"
            matInput
            formControlName="description"
            rows="5"
            [placeholder]="'documents.form.descriptionPlaceholder' | translate"
          ></textarea>
        </div>

        <!-- File Upload -->
        <div class="file-upload-container">
          <div class="file-upload-label">
            <span [class.arabic-font]="isRTL">{{
              "documents.form.attachment" | translate
            }}</span>
            <span class="required-indicator">*</span>
          </div>

          <div
            class="file-upload-area"
            [class.has-file]="selectedFile"
          [class.invalid]="
            documentForm.get('file')?.invalid &&
            documentForm.get('file')?.touched
          "
            >
            <input
              type="file"
              #fileInput
              accept=".pdf"
              class="file-input"
              (change)="onFileSelected($event)"
              />

              <div class="upload-content">
                <mat-icon>upload_file</mat-icon>
                @if (!selectedFile) {
                  <span [class.arabic-font]="isRTL">
                    {{ "documents.create.dragDrop" | translate }}
                  </span>
                }
                @if (selectedFile) {
                  <span
                    class="file-name"
                    [class.arabic-font]="isRTL"
                    >
                    {{ getFileNameFromPath(selectedFile.name) }}
                  </span>
                }
                <button
                  type="button"
                  mat-stroked-button
                  color="primary"
                  (click)="fileInput.click()"
                  class="browse-btn"
                  >
                  {{ "documents.create.selectFile" | translate }}
                </button>
              </div>
            </div>

            @if (
              documentForm.get('file')?.invalid &&
              documentForm.get('file')?.touched
              ) {
              <div
                class="error-message"
                >
                {{ "documents.create.validation.required" | translate }}
              </div>
            }
          </div>
        </form>
      </mat-dialog-content>

      <mat-dialog-actions align="end">
        <button mat-button (click)="onCancel()" [class.arabic-font]="isRTL">
          {{ "common.cancel" | translate }}
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="onSubmit()"
          [disabled]="documentForm.invalid"
          [class.arabic-font]="isRTL"
          >
          {{ "common.save" | translate }}
        </button>
      </mat-dialog-actions>
    </div>
